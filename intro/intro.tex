\documentclass[phd]{infthesis}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[british]{babel}
\usepackage{microtype}
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
\usepackage[english=british,autopunct=false]{csquotes}
\usepackage[natbib=true,style=authoryear-comp,maxbibnames=6]{biblatex}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{wrapfig}
\usepackage{xfrac}
\usepackage{xspace}
\usepackage{mathcommon}
\usepackage[sc]{mathpazo}
\usepackage{hyperref}
\usepackage{expl3}
\usepackage{enumitem}
\usepackage{booktabs}
\usepackage{tabularx}
\usepackage{mathpartir}
\usepackage{fancyvrb}
\usepackage{inconsolata}
\usepackage{multirow}

\frenchspacing

% Bibliography
\addbibresource{intro.bib}
\bibliography{intro}

% Text
\newcommand{\ie}{i.e.\xspace}
\newcommand{\eg}{e.g.\xspace}

% Referencing
\newcommand{\chp}[1]{\S\ref{chp:#1}}
\newcommand{\sct}[1]{\S\ref{sec:#1}}
\newcommand{\ssec}[1]{\S\ref{subsec:#1}}
\newcommand{\eqn}[1]{Eq.~\ref{eq:#1}}
\newcommand{\eqns}[2]{Eq. \ref{eq:#1} and \ref{eq:#2}}
\newcommand{\lem}[1]{Lemma~\ref{lemma:#1}}
\newcommand{\lems}[2]{Lemmas \ref{lemma:#1} and \ref{lemma:#2}}
\newcommand{\thm}[1]{Th.~\ref{thm:#1}}
\newcommand{\fig}[1]{Fig.~\ref{fig:#1}}
\newcommand{\diagram}[1]{diagram~\ref{eq:#1}}
\newcommand{\app}[1]{Appendix~\ref{app:#1}}
\newcommand{\mcite}[1]{\textcolor{gray}{#1}} % missing cite
\newcommand{\defn}[1]{Def.~\ref{def:#1}}
\newcommand{\prop}[1]{Prop.~\ref{prop:#1}}

% Math
\renewcommand{\tuple}[1]{(#1)}
\DeclareMathOperator*{\expn}{exp}
\renewcommand*{\exp}[1]{e^{\,#1}} % \mathrm{e}^{#1}}
\renewcommand{\qedsymbol}{\ensuremath{\blacksquare}}
\newcommand{\partialto}{\rightharpoonup}
\newcommand{\id}{\vec{1}} % identity function
\newcommand{\mr}[1]{\mathrm{#1}}

\newcommand{\den}[1]{\llbracket #1 \rrbracket}
\newcommand{\m}[1]{\{\!| #1 |\!\}}
\newcommand{\M}[1]{\mathcal{#1}}
\newcommand{\MS}[0]{\mathrm{M}}
\newcommand{\SQ}[0]{\mathrm{S}}
\newcommand{\s}[1]{\underline{#1}}
\newcommand{\G}[0]{\Gamma}
\newcommand{\D}[0]{\Delta}
\newcommand{\mytt}{t\!t}
\newcommand{\myff}{f\!\!f}

\newcommand{\V}{\mathrm{V}}

\newcommand{\sel}{\mathrm{sel}}
\newcommand{\fold}{\mathrm{fold}}

\newcommand{\ms}{\mathrm{ms}}


\newtheorem{mydef}{Definition}
\def\dotminus{\mathbin{\ooalign{\hss\raise1ex\hbox{.}\hss\cr
  \mathsurround=0pt$-$}}}
\setlength{\tabcolsep}{8pt}
\renewcommand{\arraystretch}{1.0}

\newcommand{\match}{m}
\newcommand{\up}[1]{\uparrow\! #1}

\newcommand{\n}{\mathrm{n}}

% Other stuff
\newcommand{\maybe}[1]{\textcolor{gray}{#1}}
\newcommand{\todo}[1]{\textcolor{red}{TODO: #1}}

% rules
\newcommand{\ar}[2]{\mr{#1} \! = \! {#2}}

\setlength{\tabcolsep}{8pt}
\renewcommand{\arraystretch}{1.2}

\begin{document}
\chapter{Introduction}
% In light of this discussion I will also need to change the dicsussion in the
% next chapter
%somehow need to include the word constructive more, that's key
Life is produced and sustained through the organisation of entities at various
levels that interact to construct other autonomous entities. Organisation and
structure are therefore fundamental and defining properties of all living
systems. Some go as far as to say that (self-)organisation and the resulting
self-maintenance are the only common and defining characteristics of living
organisms and that they are primary to even natural selection in shaping the
forms of life that we see \citep[sometimes referred to as structuralism, for
example;][]{thompson1942growth, kauffman1992origins}. Even if we do not take
such an extreme view, it is still true that if we want to understand life we
have to understand the organisation that sustains it and the links between
processes at all scales defined by this organisation -- from genes to organisms
and ecosystems. Organisation here means both spatial organisation, for example
cells in a tissue, but also relations or interactions between processes that
give rise to other higher-level phenomena or between processes and the
environment

% other less fundamental question could possibly be answered but at the core
% we need this
This view of organisation as a fundamental and defining principle of Biology
makes the subject distinct from other natural sciences, like Physics for example
and precludes a natural mode of enquiry, which is abstraction. The nature of the
questions is different. How can we abstract the details of an organism if those
details are exactly what makes the organism alive and in fact what we are trying
to understand? Since abstraction or at least complete abstraction is not
available, in order to answer biological questions we have to take a more
holistic and multi-scale view of the natural systems of interest.

%reductionist vs system (organisation)
Despite the importance of organisation in understanding life, historically the
focus in Biology has been on understanding individual mechanisms at the
molecular level. The reductionist view of life is that if cell is the main unit
of life then if we understand all the processes inside the cell we will
understand life as everything else follows.

There were, however, even if on the fringes or often completele outside
mainstream biology, few historical (and independent) threads of work that
recognised the importance of organisation and consequently of the systems
view. \citet{rashevsky_topology_1954} explained the need for organisation or
what he called the relational aspects of biology to complement usual approaches
that follow only the metric aspects of physical systems, which is the usual
abstraction in Physics where systems are viewed only by their quantifiable
properties (captured by numeric variables). \citet{rosen_relational_1958}
developed a theory, based on category theory, for the relational/organisational
aspects of biology and was a proponent of a systems view
\citep{rosen1991life}. \citet{varela_autopoiesis:_1974} developed the concept of
`autopoieisis' (self creation through organisation) as a necessary condition for
autonomous living entities. Following this, \citet{fontana_what_1994}
highlighted the importance of organisation as the definining characteristic of
living systems and also developed a theory of organisation as a basis for
biological understanding borrowing from computer science
\citep[$\lambda$-calculus in particular;][]{fontana_barrier_1996}. Finally, the
systems view entered the mainstream through the \emph{systems biology} movement
\citep{kitano2002systems} as a way to consolidate increasingly diverse
experimental molecular biology datasets.

% need for modelling
As the systems we are trying to understand become more complex, which is
particularly the case when we take the systems view, intuitive thinking and
mental models of the processes are not adequate tools to aid our
understanding. A useful tool in these cases is formal models where the systems
are represented using some formal language based on a mathematical
intepretation, either directly or indirectly. An interesting view is that of
formal models as machines that turn the assumptions that we put in into them to
conclusions \citep{gunawardena_models_2014}. The unique advantage of formal
models compared to informal ones (mental models) in Biology is that this machine
is guaranteed to be correct therefore providing a good tool for testing our
hypotheses (assumptions) just like an experiment would. Mental models however do
not provide this guarantee and we therefore do not know if the fault is in our
assumption or in the animation of the model in our heads.

Historically, it is no surprise that formal models have been used in systems
models, for example for morphogenesis \citep{turing_chemical_1952} and neuronal
activity \citep{hodgkin_quantitative_1952} although in some cases good
abstraction theories have been used in evolutionary genetics \citep[by
abstracting away the organism;][]{dobzhansky1982genetics} and in the small scale
for chemical kinetics \citep{michaelis1913kinetics, gunawardena_lessons_201},
\citep[see also;][]{gunawardena2013biology}. With the movement of systems
biology as the intellectual successor to the system and organisation theorists
of the 20th century we have seen an increase in mathematical models of cellular
processes, from metabolism, to the circadian clock, and .

% multi-scale models
% modelling with explicity representation of processes at multiple levels of
% organisation to understand the links between scales and how life or particular
% phenomena in life emerge through this, which cannot be explained only as a
% sum of their parts.
% also cite 
Taking the systems and modelling view to the extreme and remembering the
fundamental goal of understanding living organisms through their organisation we
can take a step further and expand our systems view from the cell to larger
scales, for example to the organism and beyond. These models that reach beyond
organisation on a single scale are usually called \emph{multi-scale models} and
they are more close to the historical spirit of understanding system
organisation to understand life, as we have seen above. For small
micro-organisms, comprehensive models link the metabolic and molecular level
with the cellular \citep{karr_whole-cell_2012} and population growth scales
\citep{weise_mechanistic_2015}. Work on more complex organisms has focused more
narrowly (Virtual liver, \citet{holzhutter2012virtual}; Virtual heart;
\citet{noble_modeling_2002}; Bone system, \citet{paoletti_multilevel_2012})
altough there are ambitious collaborative project aiming at whole organisms
\citep[virtual rat, virtual human][]{beard_multiscale_2012, kohl_systems_2009}.

%multi-scale models in plants
%plants
Plant science research is concentrated on the laboratory model species
\emph{Arabibopsis thaliana}, which offers an opportunity for broad understanding
that includes mechanistic models \citep{chew_mathematical_2014,
  voss_modelling_2014}. This multi-scale view starting from a molecular
mechanism and metabolism is realised explicitly in the Framework Model that
represents vegetative growth starting from the a specific well-understood
molecular mechanism \citet[FMv1]{chew_multiscale_2014}. On the other end of the
scales spectrum there is modelling work for plants in the crop and ecology world
where the organism is usually absent. While this work usually is concerned with
more crop or ecologically relevant species, recently Arabidopsis is starting to
appear in crop and ecology research in attempts to bring the organism back into
the equation and provide insight into relevant mechanisms that affect ecological
or crop phenotypes especially with respect to the interaction with the
environment.

The work of this thesis is situated exactly in this space, in the intersection
and modelling space between plant science and crop or ecological
research. We are particularly interested in linking multi-scale plant models
that consider growth through environmental interaction with ecological models
that consider ecosystems in the natural environment.  Apart from the scientific
challenges these multi-scale models present, in plants or elsewhere, there are
also some challenges regarding the technical language used for their
representation.

Therefore, the \emph{aims} of this thesis are:
\begin{itemize}
\item Develop a suitable notation to address the problem of naturally and
  succintly representing multi-scale plant models that go beyond the organism
  and act in a dynamic natural environment.
\item Use the above language to create such multi-scale plant models from the
  organism to the ecosystem.
\item Use the models for answering questions in ecological models using the
  mechanistic understanding that comes from including a model of the organism in
  ecological studies.
\end{itemize}

In the rest of this chapter we will first give an overview of modelling in the
plant domain starting from plant science and going to the ecology and crop
modelling. We will then overview the language question in multi-scale models that
relates to the organisation view of living organisms we noted above. Finally, we
give the contributions of this thesis in reference to the outlined aims.

\section{From plants to crops and ecosystems}
Traditional plant biology research has been focused on understanding molecular
mechanisms at the foundation of important plant processes like
photosynthesis. Unlike mammalian systems, however, the effect of environmental
conditions is usually taken into account since plants are highly dependent on
those. The importance for crop traits also led to attempts at linking molecular
knowledge to organism traits, like growth. We can think of these kind of questions
of how a particular phenotypic trait arises from a molecular mechanism as the
\emph{how} questions (top part of cycle in Figure~\ref{fig:circle}.

\begin{figure}[tb]
  \centering
  \includegraphics[width=0.8\textwidth]{figures/circle.eps}
  \caption{Plant biology research is usually concerned with the top part of the
    cycle and the 'how' of organisms. Evolution and ecology are concenred with
    the why although they usually use a limited view of the 'how' to make
    hypotheses about the 'why'.}
  \label{fig:circle}
\end{figure}

In the fields of ecology and evolution on the other hand, the question are more
on they \emph{why} organisms evolved the way they have (bottom part of cycle in
Figure~\ref{fig:circle}. This is usually done by observing genetic variation and
with some knowledge of the how this affect organism behaviour make evolutionary
hypotheses on the why.

Multi-scale plant models that go beyond the organism can be seen as tools for
understanding (evolutionary ecology) and tools for engineering (crop
science). Next, we start with plant models with an emphasis on the Framework
Model of \citet{chew_multiscale_2014} and go to an overview of crops and
evolutionary ecology models.

\subsection{Multi-scale plant models}
Modelling in plant biology is usually concerned with individual mechanisms, for
example photosynthesis or leaf stomata conductance. What perhaps makes it
distinct from modelling work in other species is the importaance of the
environment and the attempt to link these molecular processes to organism traits
directly important for agriculture.
%examples? clock to flowering time

Unlike other organisms most of the development of plants happens throughout
their lifecycle and a lot of work was based on descriptive models of their
structural growth. As the role of molecular mechanisms into development became
clearer there is more multi-scale work linking molecular mechanisms to
development, for example there are models of the distribution of the hormone
auxin along the plant structure, which is known to act as a
morphogen. Functional-structural models also try to link molecular mechanisms,
usually abstract views of metabolism, to structural growth at the organ level.

Plant development models usually ignore most of the underlying biochemistry of
the organism except for a very narrow description of directly relevant molecular
mechanisms. On the other hand models of molecular mechanisms, while sometimes
linked to the organism, they usually ignore the constructive organisation of the
plant. The question is can we construct the organism representing its
contstructive organisation and underlying mechanisms? We next overview one
attempt at a digital organism, the Framework Model, which is inspired by the
functional-structural models.

% Then FM more multi-scale
% ->
\subsubsection*{Framework Model}
The Framework Model represents vegetative growth of Arabidopsis in lab conditions
\citep{chew_multiscale_2014}, starting from four independent models that
represent photosynthesis and carbon storage \citep{rasse_leaf_2006}, plant
structure and carbon partitioning among organs
\citep{christophe_model-based_2008}, flowering phenology
\citep{chew_augmented_2012} and the circadian clock gene circuit and its output
to photoperiodic flowering \citep{salazar_prediction_2009}. Later updates
focussed on plant phenotypes controlled by the clock, such as tissue elongation
and starch metabolism \citep[FMv2;][]{chew_linking_2017}, or temperature and
organ-specific inputs to flowering
\citep{kinmonth-schultz_mechanistic_2018}. The Framework Models align with
community efforts to link understanding of crop plant processes at multiple
scales, for benefits in agriculture \citep{wu_connecting_2016, zhu_plants_2016}.

Among the limitations of the Framework Models, growth was limited to the
vegetative stage, ending upon flower induction. Without reproduction, the models
had no seed yield or link to evolutionary fitness. Without seed dormancy, they
lacked a major determinant of Arabidopsis life history in the field. Their
representation of the circadian clock was also unnecessarily detailed for many
studies outside chronobiology. These limitations mean that going beyond the
organism to the population level to answer ecological questions is not possible.

\subsection{Crop modelling}
%for understanding vs for engineering
% crops
Crop models use many of the same ideas that we have seen in multi-scale plant
models but they have a different more engineering oriented goal in mind instead
of the fundemantal biology goal of understanding. Usually the motivation is
understanding the effect of interventions to either plant genetics or crop
management on plant performance, which is usually growth related.

% traditional crop models
Traditionally in crop models the entire crop is seen as one big plant. The
challenges relate exaclty to this assumption. For example, computing light
interception of the canopy has to take into account the geometry and assumed
configuration and positioning of plants in the field. The constructive
organisation of plants is absent and plant processes, like photosynthesis, are
scaled to the entire crop. Genetics or molecular mechanisms are represented, if
at all, in a phenomenological way. For example, a mutant might have a different
set of photosynthesis parameters and so on.

Since the goal in this models is prediction, as long as these models come
reasonably close to the behaviour of the crop under different environmental
conditions they are considered to be adequate representations. However, because
of their nature it becomes difficult to capture the responses of the systems
under multiple environmental inputs.

\subsubsection*{A flows-based view of a plant}
Other approaches start from a whole-plant model and then try to extrapolate to
the entire crop. This usual representation is of the plant as multiple
reservoirs of nutrients with flows between them. Growth, which is the main goal
usually, is calculated as a function of the levels in these nutrient pools.

%figure here, this view is important for later

This view has later found its way into more traditional plant models and it is
the metabolism level representation found in the Framework Model, for example,
although the flows are calculated more mechanistically and the pools are the
organ level reflecting the representation of the plant organisation. Again in
this whole plant flow-based models, the constructive organisation of the plant
is absent preventing fundamental questions but as long as the goal is prediction
for engineering then sometimes this representation is adequate.


\subsubsection*{Multi-scale models}
The multi-scale systems modelling approach has also been proposed in crop
modelling in attempts to engineer crop traits starting from genetics or from
genomes \citep{welch_merging_2005, yin_applying_nodate, yin_modelling_2010,
  parent_can_2014, wu_connecting_2016, chenu_integrating_2018}, where simpler
models have demonstrated both the potential of crop modelling in general and the
significant demands of detailed models for empirical data that varies in
availability \citep{hammer_models_2006,asseng_uncertainty_2013}.


\subsection{Ecology and evolution}
The lifecycle of Arabidopis plants can be divided into three major
developmental stages where the transition between them is marked by
developmental events. Starting out as a seed the plant germinates transitioning
to the vegetative stage after which it bolts going to the reproductive stage
that ends with the dropping of the new seeds (Figure~\ref{fig:plantLife}.

In natural settings the timing of this events throughout the year
(\emph{phenology}) determines the environment that the plant is exposed to
during growth. Therefore phenology is a major determinant of plant fitness. If
growth coincides, for example, with unfavourable weather conditions the plant
might not have enough resources to put into making seeds or might not even
survive to reproduction.

\begin{figure}[tb]
\centering
\includegraphics[width=0.8\textwidth]{figures/phenology.eps}
  \caption{Plant developmental stages and timing in the year (phenology), which
    is a big determinant of fitness}
\label{fig:plantLife}
\end{figure}

Yet species have a natural geographic range that spans a wide range of climactic
conditions. For example, Arabidopsis in Europe grows naturally all the way from
Spain to Northern Finland. The hypothesis is then that the genes that control
these developmental events must be under selective pressure to adapt to
different climates. A lot of work in evolutionary ecology of plants is focused
on understanding the molecular mechanisms involved in plant adaptation through
the control of developmetal events. The assumption is then that these mechanisms
reflect adaptation to different environments and therefore hint towards the
'why' questions.

\todo{Give examples, \eg{FLC, DOG1 variation}}
% sometimes events are investigated together to see co-evolution Co-Variation
% between Seed Dormancy, Growth Rate and Flowering Time Changes with Latitude in
% Arabidopsis thaliana

\subsubsection*{Phenology models}
The hypothesis in phenology is that plants sense and integrate environmental
signals until they reach the optimal condition for triggering the transition to
the next developmental stage. There are experimental evidenence of this
integration but evidence on the mechanism are still behind altough there are is
some work pointing to the clock as a possible mechanism.

Phenology models are usually phenomenological and make no attempt to represent
the mechanism for sensing and integration of the environmental effects. Instead,
they use numerical quantities to represent the progress towards the transition,
which is an integral over time of the values of envrironmental indicators that
affect the particular stage under consideration. For example, if we know that
temperature affects a developmental stage, a phenology model might use a
temperature sum to track the progress towards the transition:
$$
d(t) = \sum_{i}^{t} T(i) - T_b
$$
The development at time $t$, $d(t)$, is the sum of the temperatures at every
time unit above a base temperature $T_b$. The transition time, $t_s$, is the
time such that the development sum reaches a threshold value, $d(t_s) >
D_s$. Incorporating genetics is usually represent by adding a sensitivity value
to the above, $ d(t) = \sum_{i}^{t} k \cdot (T(i) - T_b)$ or changing the base temperature,
$T_b$. The idea is that plants adapt by changing, $k$ or $T_b$, which reflects
some molecular mechanism, to change the length of the stage and time their
transition at the optimal time depending on the natural environment.

Modelling phenology usually goes in tandem with experimental observations about
timing but the models usually stop there and they do not deal with the
evolutionary hypotheses that usually follow. These models usually appear in
ecological studies and do not consider the genetics while the genetic studies of
developmental timing adaptation usually do not have a modelling component.

Furthermore, dealing with each developmental stage in isolation means, while
being simple and inducing simple 'why' hypotheses, is sometimes not enough as one
developmental stage affects the timing and length of the next and the length of
the entire generation affects the next generation and so on.
\todo{examples}

\subsubsection*{System models}
In order to be useful in evolutionary ecology other work has incorporated
genetics and fitness into the simple phenology models of the kind we have seen
above. \citet{chuine_phenology_2001}, for exaple, propose a model that combines
fitness with traditional phenology models to predict the distribution of a
species. The model is simple, the phenology part predicts the timing and the
fitness, given as probabilities of survival under different weather stresses,
predicts overall survival rates.

While the simple phenology models consider species mean behaviour, other work
has made the links between the genetic studies of timing mechanisms to phenology
models to understand the range of expected behaviour both within but also
between populations. For example, \citet{wilczek_effects_2009} add genetic
variation of the FLC gene (involved in control of flowering time) to a flowering
phenology model to predict variation in flowering time and vegetative season
length.

\citet{burghardt_modeling_2015} takes a more systems approach by taking an
integrative look at the whole life cycle instead of events in
isolation. Variation is also considered explicitly by using an individual-based
population model. Fitness, however, is not considered either directly as the
reproductive success of the individual in the population or indirectly as
survival rates as we have seen before. The focus is more on the timing and the
consequences of the genetic environmental interaction.

In representations in both simple and more complex evolutionary ecology models
in this domain the organism is absent. While this gives tractable
representations of complex processes and allows understanding of experimental
results, a more fundamental understanding requires the organism to fill the gaps
between the scales from genes to the population. Adding the organism to the
population level recovers a more mechanistically founded reproductive success
(fitness) as a first step towards explicitly modelling evolutionary dynamics.

\todo{Prusinkiewicz paper here?}
% People:
% Kathleen Donohue
% Amity Wilczek
% Carlos Alonso-Blanco
% Justin Borevitz
% Isabelle Chuine

% although there is more work on adaptation to other things directly like
% temperature
% See Caroline Dean and Juliette de Meaux

\section{Languages for multi-scale biology}
Models serve both as
The notation we use to describe parts of the natural or artificial world can act
as a tool for thinking about it. The characteristics that a notation for a
specific domain should have in order to be a good tool for thought have been
succinctly listed by Kenneth Iverson: ``ease of expression of common constructs
in the domain, suggestivity, ability to subordinate detail, economy, and
amenability to formal proofs" \cite{iverson2007notation}.

Modelling in biology becomes necessary when systems are complex. However, the
more complex the systems are, the harder models become to read and write.  The
fundamental difference in the question asked in Biology means that

constructive organisation that is a fundamental characteristic of the
multi-scale systems view of biological processes. This was noted since Rashevsky
who as we have seen pointed out the need for the representation of
need for discrete objects

While organisation is important especially at multi-scale representations
abstraction through quantifiable properties is also needed


See next chapter for a more detailed overview and comparison of languages in
this domain.

%refer to examples above.


\section{Contributions}
bullet points and references to later chapters
This need to be refutable, like a contract for the thesis

\begin{itemize}
\item A notation for describing systems like the ones we hinted to above at the
  intersection of plant biology models in a natural envrionment. This notation
  combines object-based discrete dynamics along with quantifiable properties
  that offer the possibility for abstraction. Further extension allows an
  enriched expression language that combines regular mathematical expressions
  with a flexible system of state observation based on database operations and a
  way of definining determinstically time-dependent values that can be used to
  describe parts of the systems or the natural envrionment that we do not wish
  to model mechanistically.
\item An extensions of the Framework Model to the full-lifecycle with
  modifcations that allow its operation realistic weather ranges. Gap between
  even multi-scale plant models like the FM and the population and ecology level.
\item An application of the Framework Model for the crop engineering
  perspective. Instead of taking the traditional approach to engineer genomes as
  we have seen we take an alternative approach that engineers the environment
  for achieving specific growth-related organism traits. We frame the problem as
  an optimal control problem and frame two instances, one where the control is
  direct and another one where the control is indirect through positioning.
\end{itemize}

\printbibliography[heading=bibintoc]
\end{document}

% I think for the conclusion we somehow need to link to the multi-language for
% each scale and then one for the organisation, not sure