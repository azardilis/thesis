\documentclass[phd, logo]{infthesis}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[british]{babel}
\usepackage{microtype}
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
\usepackage[english=british,autopunct=false]{csquotes}
\usepackage[natbib=true,style=authoryear-comp, maxbibnames=6, maxcitenames=2]{biblatex}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{wrapfig}
\usepackage{xfrac}
\usepackage{xspace}
\usepackage{mathcommon}
%\usepackage[sc]{mathpazo}
\usepackage{hyperref}
\usepackage{expl3}
\usepackage{enumitem}
\usepackage{booktabs}
\usepackage{tabularx}
\usepackage{mathpartir}
\usepackage{fancyvrb}
\usepackage{multirow}
\usepackage{caption}
\usepackage[toc,page]{appendix}

\frenchspacing


% Bibliography
\addbibresource{thesis2.bib}
\bibliography{thesis2}

% Text
\newcommand{\ie}{i.e.\xspace}
\newcommand{\eg}{e.g.\xspace}

% Referencing
\newcommand{\chp}[1]{\S\ref{chp:#1}}
\newcommand{\sct}[1]{\S\ref{sec:#1}}
\newcommand{\ssec}[1]{\S\ref{subsec:#1}}
\newcommand{\eqn}[1]{Eq.~\ref{eq:#1}}
\newcommand{\eqns}[2]{Eq. \ref{eq:#1} and \ref{eq:#2}}
\newcommand{\lem}[1]{Lemma~\ref{lemma:#1}}
\newcommand{\lems}[2]{Lemmas \ref{lemma:#1} and \ref{lemma:#2}}
\newcommand{\thm}[1]{Th.~\ref{thm:#1}}
\newcommand{\fig}[1]{Fig.~\ref{fig:#1}}
\newcommand{\diagram}[1]{diagram~\ref{eq:#1}}
\newcommand{\app}[1]{Appendix~\ref{app:#1}}
\newcommand{\mcite}[1]{\textcolor{gray}{#1}} % missing cite
\newcommand{\defn}[1]{Def.~\ref{def:#1}}
\newcommand{\prop}[1]{Prop.~\ref{prop:#1}}

% Math
\renewcommand{\tuple}[1]{\left(#1\right)}
\DeclareMathOperator*{\expn}{exp}
\renewcommand*{\exp}[1]{e^{\,#1}} % \mathrm{e}^{#1}}
\renewcommand{\qedsymbol}{\ensuremath{\blacksquare}}
\newcommand{\partialto}{\rightharpoonup}
\newcommand{\id}{\vec{1}} % identity function
\newcommand{\mr}[1]{\mathrm{#1}}

\newcommand{\den}[1]{\llbracket #1 \rrbracket}
\newcommand{\m}[1]{\{\!| #1 |\!\}}
\newcommand{\M}[1]{\mathcal{#1}}
\newcommand{\MS}[0]{\mathrm{M}}
\newcommand{\SQ}[0]{\mathrm{S}}
\newcommand{\s}[1]{\underline{#1}}
\newcommand{\G}[0]{\Gamma}
\newcommand{\D}[0]{\Delta}
\newcommand{\mytt}{t\!t}
\newcommand{\myff}{f\!\!f}

\newcommand{\V}{\mathrm{V}}

\newcommand{\sel}{\mathrm{sel}}
\newcommand{\fold}{\mathrm{fold}}

\newcommand{\ms}{\mathrm{ms}}


\newtheorem{mydef}{Definition}
\def\dotminus{\mathbin{\ooalign{\hss\raise1ex\hbox{.}\hss\cr
  \mathsurround=0pt$-$}}}
\setlength{\tabcolsep}{8pt}
\renewcommand{\arraystretch}{1.0}

\newcommand{\match}{m}
\newcommand{\up}[1]{\uparrow\! #1}

\newcommand{\n}{\mathrm{n}}


% Other stuff
\newcommand{\maybe}[1]{\textcolor{gray}{#1}}
\newcommand{\todo}[1]{\textcolor{red}{TODO: #1}}

% rules
\newcommand{\ar}[2]{\mr{#1} \! = \! {#2}}

\setlength{\tabcolsep}{8pt}
\renewcommand{\arraystretch}{1.2}


% Header
\title{A modelling language for biology with applications}
\author{Argyris Zardilis}

\abstract{

  Understanding the links between biological processes at multiple scales, from
  molecular regulation to populations and evolution along with their
  interactions with the environment, is a major challenge in understanding
  life. Apart from understanding this is also becoming important in attempts to
  engineer traits, for example in crops, starting from genetics or from genomes
  and at different environmental conditions (genotype x environment ->
  trait). As systems become more complex relying on intuition alone is not
  enough and formal modelling becomes necessary for integrating data across
  different processes and allowing us to test hypotheses. The more complex the
  systems become, however, the harder the modelling process becomes and the
  harder the models become to read and write. In particular intuitive formalisms
  like Chemical Reaction Networks are not powerful enough to express ideas at
  higher levels, for example dynamic environments, dynamic state spaces, and
  abstraction relations between different parts of the model. Other formalisms
  are more powerful (for example general purpose programming languages) but they
  lack the readability of more domain specific approaches.

  The first contribution of this thesis is a modelling language with stochastic
  semantics, Chromar, that extends the visually intuitive formalisms of
  reactions, in which simple objects, called agents, are extended with
  attributes. Dynamics are given as stochastic rules that can operate on the
  level of agents (removing/adding) or at the level of attributes (updating
  their values). Chromar further allows the seamless integration of time and
  state functions with the normal set of expressions – crucial in multi-scale
  plant models for describing the changing environment and abstractions between
  different scales.  This leads to models that are both formal enough for
  simulations and easy to read and write.

  The second contribution of this thesis is a whole-life-cycle multi-model of
  the growth and reproduction of \textiit{Arabidopsis Thaliana}, FM-life,
  expressed in a declarative way in Chromar. It combines phenology models from
  ecology to time developmental processes and physical development, which allows
  to scale to the population and address ecological questions at different
  genotype x environment scenarios. This is a step in the path for mechanistic
  links between genotype x environment and higher-level crop traits.

  Finally, I show a way of using optimal control techniques to engineer traits
  of plants by controlling their growth environmental conditions. In particular
  we explore (i) a direct problem where the control is temperature – assuming
  homogeneous growth conditions and (ii) indirect problem where the control is
  the position of the plants -- assuming inhomogeneous growth conditions.
}

% Abstract
\begin{document}

%% First, the preliminary pages
\begin{preliminary}

  \maketitle

  \begin{frontenv}{Lay Summary}{\LARGE}
    Living organisms are often viewed as hierarchical. Entities at one level
    (\eg cells) function and organise giving rise to properties of entities at
    the next level (\eg tissues) and they in turn to the next until we get to
    the level of a living organism. If we want to understand life, which is the
    most fundamental question in biology, we need to understand the processes
    and the links between them across these levels. As the systems we are trying
    to understand become more complex, holding all the interactions in our heads
    as mental models becomes difficult (or impossible). One way to solve this is
    by using formal models written in some technical language (\eg mathematical
    equations). The advantage is that these can be manipulated in predefined
    ways, for example setting them in motion inside a computer, without the
    danger of missing anything. When trying to understand all the scales that
    make up an organism though, some of these languages become hard to read and
    write and can no longer serve as documentations of our understanding.

    In this thesis I first present a formal language, \emph{Chromar}, which has
    some features that make writing a class of multi-scale models easier. Some
    of these features include mixing discrete with continuous entities, for
    example you can describe how cells are created or destroyed (discrete) but
    also how the size of cells changes (continuous). It also allows the
    mixing of deterministic with stochastic dynamics.

    I then use this language to describe in a model the whole lifecycle (from
    seed to seed) of the plant Arabidopsis Thaliana, a commonly used organism in
    plant research, by combining or extending existing models. Such a model
    allows then multiple generations and the observation over time of
    populations of plants in environmental conditions of our choice. We can then
    compare populations of different types of plants in different scenarios and
    ask which type is more succesful in reproducing in some conditions. This
    might give us some hints on why some types of plants adapted to specific
    locations.

    Finally, since there are now solutions that allow more precise control over
    the surrounding environment (think more precise and controlled greenhouses),
    one might ask if it is possible to find and use optimal environmental
    conditions (\eg temperature) to achieve specific trais of plants. Here I use
    one of these comprehensive plant models along with other mathematical
    techniques to address this question.
\end{frontenv}\newpage

  \begin{acknowledgements}
I would like to thank everyone that has helped along the way. It has been a
journey with many ups and downs that has transformed me in many ways for the better.

First I would like to thank my supervisor Andrew Millar for being an inspiration
both as a scientist and as a person and for believing in me even when things
did not look great. This thesis would not have been possible without Gordon
Plotkin and Ricarco Honorato-Zimmer. Apart from technical discussions and help,
their enthusiasm and appetite for new ideas have sparked my own enthusiasm when
I seemed to had forgotten it. Their clarity of mind has shaped my own
thinking. Filippo Menolascina also, who I have worked with the last months, that
with his positivity also reminded of the fun of doing research.

I would like to thank my parents that with their presence throughout my life
have shaped my beliefs and attitude in life. Their continuous support along
with my sister has been immensely helpful also during this PhD and especially
these last few months that were very difficult for me. I cannot imagine how it
would have been without them.

I feel very grateful to my friends Alex, Panicos, Kyriacos, and
Constantinos. Even though they were physically very far, they were always
close. Also my friends in Edinburgh: Ira, Jeanne, Manuel, Kristyna, Anik, Uriel
and everyone. They have kept me positive and reminded of the point of it all
when I sometimes kept forgetting it. I feel very lucky to have met you and even
if I picked up a tiny amount of you through our interactions it has made me a
much better person. Also the greek gang, Iordanis, Chris and Chris, Andreas,
Pigi, Giannis, Irene. I cannot imagine Edinburgh without you. I am especially
grateful to my flatmate Andreas that with his humour kept me in touch with
reality.

Finally, I would like to thank everyone in the Millar group and the RBM group in
Informatics especially Yin-Hoon Chew, Daniel Seaton, and Uriel Urquiza. It was
great to work and share ideas with you all.

\end{acknowledgements}

%% Next we need to have the declaration.
\standarddeclaration

%% Create the table of contents
\tableofcontents

\end{preliminary}

\chapter{Introduction}
\label{chp:intro}
\input{chapters/intro}

\chapter{Background and Related Work}
\label{chp:relWork}
\input{chapters/relWork}

\chapter{Chromar by example}
\label{chp:chromarEx}
\input{chapters/chromarEx}

\chapter{Chromar: formal definition}
\label{chp:chromarForm}
\input{chapters/chromarForm}

\chapter{Implemented Chromar}
\label{chp:chromarImpl}
\input{chapters/chromarImpl}

\chapter{Framework Models}
\label{chp:fms}
\input{chapters/fms}

\chapter{Optimal control of plant traits}
\label{chp:oc}
\input{chapters/oc}

\chapter{Conclusions}
\label{chp:concl}
\input{chapters/concl}


\singlespace

%% Specify the bibliography file. Default is thesis.bib.
% \bibliography{thesis}

\printbibliography[heading=bibintoc]

\appendix
\chapter{Additional FM-life population simulations}
\label{app:fmLifeMore}
\input{chapters/appendix}

%% ... that's all, folks!
\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
